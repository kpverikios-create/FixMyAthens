<!DOCTYPE html>
<html lang="el">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>FixMyAthens ‚Äî Œ§ŒµœáŒΩŒπŒ∫œåœÇ Œ¨ŒºŒµœÉŒ± œÉœÑŒ∑ŒΩ ŒëŒ∏ŒÆŒΩŒ±</title>

  <meta name="theme-color" content="#0f172a"/>
  <link rel="manifest" href="/manifest.json">

  <style>
    :root {
      --bg:#0f172a;
      --surface:#111827;
      --surface-soft:#1e2537;
      --stroke:rgba(255,255,255,0.07);
      --accent:#38bdf8;
      --text-primary:#f8fafc;
      --text-dim:#9ca3af;
      --radius-lg:20px;
      --radius-md:12px;
      --font:-apple-system,BlinkMacSystemFont,"Inter",Roboto,"Helvetica Neue",Arial,sans-serif;
    }

    *{box-sizing:border-box;margin:0;padding:0;}

    body{
      background:radial-gradient(circle at 20% 20%,rgba(56,189,248,.18) 0%,rgba(15,23,42,0) 60%),var(--bg);
      color:var(--text-primary);
      font-family:var(--font);
      -webkit-font-smoothing:antialiased;
      line-height:1.45;
    }

    .page{
      max-width:1200px;
      margin:0 auto;
      padding:24px clamp(16px,2vw,32px) 80px;
    }

    header.navbar{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      flex-wrap:wrap;
      margin-bottom:32px;
    }

    .brand-wrap{
      display:flex;
      align-items:center;
      gap:12px;
    }

    .brand-icon{
      width:44px;
      height:44px;
      border-radius:12px;
      background:linear-gradient(150deg,#1f2937 0%,#0f172a 60%);
      border:1px solid rgba(255,255,255,0.12);
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:0.7rem;
      font-weight:600;
      color:var(--accent);
      line-height:1.2;
      text-align:center;
    }

    .brand-text-head{
      font-size:1.05rem;
      font-weight:600;
      color:var(--text-primary);
      letter-spacing:-0.03em;
    }

    .brand-text-sub{
      font-size:0.8rem;
      color:var(--text-dim);
      line-height:1.3;
    }

    .admin-bar{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
    }

    .pill{
      background:rgba(255,255,255,0.03);
      border:1px solid var(--stroke);
      color:var(--text-dim);
      border-radius:999px;
      font-size:0.7rem;
      padding:6px 10px;
      line-height:1.2;
      white-space:nowrap;
    }

    .admin-btn{
      background:transparent;
      border:1px solid var(--stroke);
      color:var(--text-primary);
      border-radius:var(--radius-md);
      font-size:0.75rem;
      font-weight:500;
      padding:8px 12px;
      cursor:pointer;
    }
    .admin-btn:active{scale:.97;}

    /* HERO */
    .hero{
      display:grid;
      grid-template-columns:1fr;
      gap:24px;
      margin-bottom:32px;
    }
    @media(min-width:900px){
      .hero{
        grid-template-columns:minmax(0,1fr) 400px;
      }
    }

    .hero-copy h1{
      font-size:clamp(1.4rem,1vw,1.6rem);
      font-weight:600;
      color:var(--text-primary);
      letter-spacing:-0.04em;
      line-height:1.2;
      margin-bottom:12px;
    }

    .hero-copy .subtitle{
      font-size:0.9rem;
      color:var(--text-dim);
      max-width:600px;
      line-height:1.5;
    }

    .hero-highlights{
      display:flex;
      flex-wrap:wrap;
      gap:12px;
      margin-top:20px;
    }

    .chip{
      background:rgba(56,189,248,0.08);
      color:var(--accent);
      border:1px solid rgba(56,189,248,0.4);
      border-radius:var(--radius-md);
      font-size:0.7rem;
      font-weight:500;
      padding:6px 10px;
      line-height:1.2;
      white-space:nowrap;
    }

    .chip.dim{
      background:rgba(255,255,255,0.03);
      color:var(--text-dim);
      border:1px solid var(--stroke);
    }

    /* APP CARD */
    .app-card{
      background:linear-gradient(145deg,#1f2535 0%,#111827 50%);
      border-radius:var(--radius-lg);
      border:1px solid rgba(255,255,255,0.08);
      box-shadow:0 40px 160px rgba(0,0,0,0.9);
      padding:20px 20px 16px;
      display:flex;
      flex-direction:column;
      gap:20px;
    }

    .section-head{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
    }
    .section-title{
      font-size:0.9rem;
      font-weight:600;
      color:var(--text-primary);
      letter-spacing:-0.03em;
      display:flex;
      flex-direction:column;
      line-height:1.3;
    }
    .section-desc{
      font-size:0.75rem;
      font-weight:400;
      color:var(--text-dim);
      line-height:1.4;
    }

    .btn-main{
      width:100%;
      background:var(--accent);
      color:#06121f;
      border:none;
      border-radius:var(--radius-md);
      font-weight:600;
      font-size:0.9rem;
      padding:12px 14px;
      cursor:pointer;
      text-align:center;
    }
    .btn-main:active{scale:.98;}

    .two-col{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:12px;
    }

    /* FORMS */
    .panel{
      background:rgba(15,23,42,0.6);
      border-radius:var(--radius-md);
      border:1px solid var(--stroke);
      padding:16px;
    }

    label{
      font-size:0.75rem;
      font-weight:500;
      color:var(--text-primary);
      margin-bottom:4px;
      display:block;
      letter-spacing:-0.03em;
    }

    select,
    input,
    textarea{
      width:100%;
      background:#0b1118;
      border:1px solid rgba(255,255,255,0.08);
      border-radius:var(--radius-md);
      color:var(--text-primary);
      font-size:0.85rem;
      line-height:1.4;
      padding:12px;
      font-family:var(--font);
      outline:none;
    }

    select:focus,
    input:focus,
    textarea:focus{
      border:1px solid var(--accent);
      box-shadow:0 0 0 4px rgba(56,189,248,0.18);
    }

    .form-row-inline{
      display:flex;
      gap:12px;
      flex-wrap:wrap;
    }

    .note{
      font-size:0.7rem;
      color:var(--text-dim);
      line-height:1.4;
    }

    .btn-row{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      margin-top:12px;
    }

    .btn-secondary{
      flex:1;
      background:transparent;
      border:1px solid var(--stroke);
      color:var(--text-primary);
      border-radius:var(--radius-md);
      font-weight:500;
      font-size:0.8rem;
      padding:12px;
      text-align:center;
      cursor:pointer;
    }
    .btn-secondary:active{scale:.98;}

    .btn-accent{
      flex:1;
      background:var(--accent);
      border:none;
      color:#06121f;
      border-radius:var(--radius-md);
      font-weight:600;
      font-size:0.8rem;
      padding:12px;
      text-align:center;
      cursor:pointer;
    }
    .btn-accent:active{scale:.98;}

    /* RESULTS LIST */
    .result-list{
      display:flex;
      flex-direction:column;
      gap:12px;
      margin-top:8px;
    }

    .result-item{
      background:rgba(255,255,255,0.02);
      border:1px solid var(--stroke);
      border-radius:var(--radius-md);
      padding:14px;
      display:flex;
      flex-direction:column;
      gap:12px;
    }
    @media(min-width:480px){
      .result-item{
        flex-direction:row;
        justify-content:space-between;
        align-items:flex-start;
      }
    }

    .result-left-title{
      font-size:0.9rem;
      font-weight:600;
      color:var(--text-primary);
      letter-spacing:-0.03em;
      margin-bottom:4px;
    }

    .result-left-sub{
      font-size:0.75rem;
      color:var(--text-dim);
      line-height:1.4;
    }

    .coverage{
      font-size:0.7rem;
      color:var(--text-dim);
      margin-top:6px;
      line-height:1.4;
    }

    .action-row{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
    }

    .mini-btn{
      flex:1;
      background:#1e293b;
      border:1px solid var(--stroke);
      color:var(--text-primary);
      font-size:0.75rem;
      font-weight:600;
      line-height:1.2;
      border-radius:var(--radius-md);
      padding:10px 12px;
      cursor:pointer;
      text-align:center;
    }
    .mini-btn.call{
      background:#10b981;
      border:1px solid #10b981;
      color:#062017;
    }
    .mini-btn.wa{
      background:#25D366;
      border:1px solid #25D366;
      color:#062017;
    }
    .mini-btn:active{scale:.98;}

    .empty-state{
      font-size:0.8rem;
      color:var(--text-dim);
      background:rgba(255,255,255,0.02);
      border:1px solid var(--stroke);
      border-radius:var(--radius-md);
      padding:16px;
      line-height:1.5;
    }

    .success-box{
      background:rgba(16,185,129,0.08);
      border:1px solid rgba(16,185,129,0.4);
      color:#6ee7b7;
      border-radius:var(--radius-md);
      font-size:0.8rem;
      line-height:1.5;
      padding:16px;
    }

    footer.footer{
      margin-top:48px;
      color:var(--text-dim);
      font-size:0.7rem;
      line-height:1.5;
      text-align:center;
      border-top:1px solid rgba(255,255,255,0.05);
      padding-top:24px;
      max-width:700px;
    }
  </style>
</head>
<body>
  <div class="page">

    <!-- NAV / HEADER -->
    <header class="navbar">
      <div class="brand-wrap">
        <div class="brand-icon">
          üîß<br>FMA
        </div>
        <div>
          <div class="brand-text-head">FixMyAthens</div>
          <div class="brand-text-sub">Œ§ŒµœáŒΩŒπŒ∫œåœÇ Œ¨ŒºŒµœÉŒ± œÉŒµ ŒëŒ∏ŒÆŒΩŒ± & œÄœÅŒøŒ¨œÉœÑŒπŒ±</div>
        </div>
      </div>

      <div id="adminBar" class="admin-bar" style="display:none;">
        <div class="pill">5‚Ç¨ / Œ¥ŒøœÖŒªŒµŒπŒ¨ (pay-per-lead)</div>
        <button class="admin-btn" id="exportCsvBtn">ŒõŒÆœàŒ∑ Leads (CSV)</button>
      </div>
    </header>

    <!-- HERO SECTION -->
    <section class="hero">
      <div class="hero-copy">
        <h1>ŒßœÅŒµŒπŒ¨Œ∂ŒµœÉŒ±Œπ Œ¨ŒºŒµœÉŒ± œÑŒµœáŒΩŒπŒ∫œå; üëá</h1>
        <div class="subtitle">
          ŒîŒπŒ¨ŒªŒµŒæŒµ ŒµŒπŒ¥ŒπŒ∫œåœÑŒ∑œÑŒ±, Œ≥œÅŒ¨œàŒµ œÑŒø œÄœÅœåŒ≤ŒªŒ∑ŒºŒ±, Œ∫Œ±Œπ Œ∏Œ± Œ¥ŒµŒπœÇ
          Œ¥ŒπŒ±Œ∏Œ≠œÉŒπŒºŒøœÖœÇ ŒºŒ¨œÉœÑŒøœÅŒµœÇ Œ≥ŒπŒ± œÑŒ∑ŒΩ œÄŒµœÅŒπŒøœáŒÆ œÉŒøœÖ. Œ§ŒøœÖœÇ Œ∫Œ±ŒªŒµŒØœÇ ŒÆ
          œÑŒøœÖœÇ œÉœÑŒ≠ŒªŒΩŒµŒπœÇ WhatsApp ŒºŒ≠œÉŒ± Œ±œÄœå œÑŒ∑ŒΩ ŒµœÜŒ±œÅŒºŒøŒ≥ŒÆ.
        </div>

        <div class="hero-highlights">
          <div class="chip">ŒöŒªŒÆœÉŒ∑ Œ∫Œ±œÑŒµœÖŒ∏ŒµŒØŒ±ŒΩ œÉœÑŒøŒΩ ŒºŒ¨œÉœÑŒøœÅŒ±</div>
          <div class="chip">WhatsApp ŒºŒµ 1 œÄŒ¨œÑŒ∑ŒºŒ±</div>
          <div class="chip dim">ŒëŒ∏ŒÆŒΩŒ± / ŒùœåœÑŒπŒ± / ŒöŒ≠ŒΩœÑœÅŒø</div>
        </div>
      </div>

      <div class="hero-side">
        <!-- APP CARD: STEP 1 -->
        <div id="homeCard" class="app-card">
          <div class="section-head">
            <div class="section-title">
              <span>1. Œ§Œπ ŒºŒ¨œÉœÑŒøœÅŒ± œáœÅŒµŒπŒ¨Œ∂ŒµœÉŒ±Œπ;</span>
              <span class="section-desc">ŒïœÄŒØŒªŒµŒæŒµ œÖœÄŒ∑œÅŒµœÉŒØŒ±</span>
            </div>
          </div>

          <div class="two-col" id="serviceGrid">
            <!-- Œ≥ŒµŒºŒØŒ∂ŒµŒπ Œ¥œÖŒΩŒ±ŒºŒπŒ∫Œ¨ -->
          </div>

          <button class="btn-main" id="toFormBtn">Œ£œÖŒΩŒ≠œáŒµŒπŒ±</button>
        </div>

        <!-- APP CARD: STEP 2 (form) -->
        <div id="formCard" class="app-card" style="display:none;">
          <div class="section-head">
            <div class="section-title">
              <span>2. Œ†ŒµœÅŒπŒ≠Œ≥œÅŒ±œàŒµ œÑŒø œÄœÅœåŒ≤ŒªŒ∑ŒºŒ±</span>
              <span class="section-desc">ŒòŒ± œÉŒøœÖ Œ¥ŒµŒØŒæŒøœÖŒºŒµ œÄŒøŒπŒøŒπ ŒµŒØŒΩŒ±Œπ Œ¥ŒπŒ±Œ∏Œ≠œÉŒπŒºŒøŒπ</span>
            </div>
          </div>

          <div class="panel">
            <label>ŒïŒπŒ¥ŒπŒ∫œåœÑŒ∑œÑŒ±</label>
            <select id="serviceSelect"></select>

            <label>Œ†ŒµœÅŒπŒøœáŒÆ / ŒìŒµŒπœÑŒøŒΩŒπŒ¨</label>
            <input id="areaInput" placeholder="œÄ.œá. Œ†Œ±Œ≥Œ∫œÅŒ¨œÑŒπ" />

            <label>Œ§Œπ Œ≠œáŒµŒπ œÉœÖŒºŒ≤ŒµŒØ;</label>
            <textarea id="descInput" rows="3" placeholder="Œ†.œá. œÑœÅŒ≠œáŒµŒπ ŒΩŒµœÅœå Œ±œÄœå œÑŒøŒΩ ŒΩŒπœÄœÑŒÆœÅŒ±"></textarea>

            <div class="form-row-inline">
              <div style="flex:1;min-width:120px;">
                <label>Œ†œåœÑŒµ œÑŒø Œ∏Œ≠ŒªŒµŒπœÇ;</label>
                <select id="urgencySelect">
                  <option>Œ£ŒÆŒºŒµœÅŒ± (Œ≠Œ∫œÑŒ±Œ∫œÑŒø)</option>
                  <option>ŒëœçœÅŒπŒø</option>
                  <option>ŒåœÄŒøœÑŒµ ŒºœÄŒøœÅŒµŒØœÑŒµ</option>
                </select>
              </div>
              <div style="flex:1;min-width:120px;">
                <label>Œ§Œ∑ŒªŒ≠œÜœâŒΩŒø</label>
                <input id="phoneInput" placeholder="69..." />
              </div>
            </div>

            <div class="note" style="margin-top:4px;">
              ŒúŒµ œÑŒ∑ŒΩ Œ±œÄŒøœÉœÑŒøŒªŒÆ, œÉœÖŒºœÜœâŒΩŒµŒØœÇ ŒΩŒ± œÉœÑŒ±ŒªŒøœçŒΩ œÑŒ± œÉœÑŒøŒπœáŒµŒØŒ± œÉŒøœÖ œÉœÑŒøŒΩ œÑŒµœáŒΩŒπŒ∫œå Œ≥ŒπŒ± ŒΩŒ± ŒµœÄŒπŒ∫ŒøŒπŒΩœâŒΩŒÆœÉŒµŒπ ŒºŒ±Œ∂ŒØ œÉŒøœÖ.
            </div>

            <div class="btn-row">
              <button class="btn-accent" id="findBtn">ŒíœÅŒµœÇ œÑŒµœáŒΩŒπŒ∫œå œÑœéœÅŒ±</button>
              <button class="btn-secondary" id="backHomeBtn">Œ†ŒØœÉœâ</button>
            </div>
          </div>
        </div>

        <!-- APP CARD: STEP 3 (results) -->
        <div id="resultsCard" class="app-card" style="display:none;">
          <div class="section-head">
            <div class="section-title">
              <span>3. ŒîŒπŒ±Œ∏Œ≠œÉŒπŒºŒøŒπ œÑŒµœáŒΩŒπŒ∫ŒøŒØ</span>
              <span class="section-desc">ŒöŒ¨ŒªŒµœÉŒ≠ œÑŒøœÖœÇ ŒÆ œÉœÑŒµŒØŒªŒµ WhatsApp</span>
            </div>
            <button class="btn-secondary" id="backToFormBtn" style="flex-shrink:0;font-size:0.7rem;padding:8px 10px;line-height:1.2;">
              Œ†ŒØœÉœâ
            </button>
          </div>

          <div id="mastersList" class="result-list"></div>

          <div id="noMasters" class="empty-state" style="display:none;">
            ŒîŒµŒΩ Œ≤œÅŒ≠Œ∏Œ∑Œ∫Œ±ŒΩ œÑŒµœáŒΩŒπŒ∫ŒøŒØ œÄŒøœÖ ŒΩŒ± Œ∫Œ±ŒªœçœÄœÑŒøœÖŒΩ Œ±œÖœÑŒÆ œÑŒ∑ŒΩ ŒµŒπŒ¥ŒπŒ∫œåœÑŒ∑œÑŒ± /
            œÄŒµœÅŒπŒøœáŒÆ Œ±œÖœÑŒÆ œÑŒ∑ œÉœÑŒπŒ≥ŒºŒÆ.
          </div>
        </div>

        <!-- APP CARD: STEP 4 (success) -->
        <div id="successCard" class="app-card" style="display:none;">
          <div class="section-head">
            <div class="section-title">
              <span>ŒïœÉœÑŒ¨ŒªŒ∑ ‚úî</span>
              <span class="section-desc">Œü œÑŒµœáŒΩŒπŒ∫œåœÇ Œ≠œáŒµŒπ œÑŒ± œÉœÑŒøŒπœáŒµŒØŒ± œÉŒøœÖ</span>
            </div>
          </div>

          <div class="success-box">
            Œ§Œø Œ±ŒØœÑŒ∑ŒºŒ¨ œÉŒøœÖ œÉœÑŒ¨ŒªŒ∏Œ∑Œ∫Œµ œÉœÑŒøŒΩ œÑŒµœáŒΩŒπŒ∫œå. ŒòŒ± œÉŒµ Œ∫Œ±ŒªŒ≠œÉŒµŒπ œÉœçŒΩœÑŒøŒºŒ±.
            ŒëŒΩ Œ∏Œ≠ŒªŒµŒπœÇ œÄŒπŒø Œ¨ŒºŒµœÉŒ±, œÄŒ¨œÑŒ± ‚ÄúŒöŒëŒõŒïŒ£Œï‚Äù œÉœÑŒøŒΩ œÑŒµœáŒΩŒπŒ∫œå œÄŒøœÖ ŒµŒØŒ¥ŒµœÇ.
          </div>

          <button class="btn-main" id="homeFromSuccess" style="margin-top:12px;">
            ŒïœÄŒπœÉœÑœÅŒøœÜŒÆ œÉœÑŒ∑ŒΩ Œ±œÅœáŒπŒ∫ŒÆ
          </button>
        </div>
      </div>
    </section>

    <!-- FOOTER -->
    <footer class="footer">
      FixMyAthens ¬© 2025 ‚Äî ŒëŒ∏ŒÆŒΩŒ±, ŒïŒªŒªŒ¨Œ¥Œ±<br><br>
      ŒúŒµ œÑŒ∑ œáœÅŒÆœÉŒ∑ œÑŒ∑œÇ œÖœÄŒ∑œÅŒµœÉŒØŒ±œÇ œÉœÖŒºœÜœâŒΩŒµŒØœÇ œåœÑŒπ œÑŒ± œÉœÑŒøŒπœáŒµŒØŒ± œÉŒøœÖ ŒºœÄŒøœÅŒøœçŒΩ
      ŒΩŒ± Œ¥ŒπŒ±Œ≤ŒπŒ≤Œ±œÉœÑŒøœçŒΩ œÉŒµ œÉœÖŒΩŒµœÅŒ≥Œ±Œ∂œåŒºŒµŒΩŒø œÑŒµœáŒΩŒπŒ∫œå Œ≥ŒπŒ± œÉŒ∫ŒøœÄŒøœçœÇ ŒµŒæœÖœÄŒ∑œÅŒ≠œÑŒ∑œÉŒ∑œÇ.
      ŒüŒπ œÑŒµœáŒΩŒπŒ∫ŒøŒØ œÄŒªŒ∑œÅœéŒΩŒøœÖŒΩ 5‚Ç¨ Œ±ŒΩŒ¨ lead (pay-per-lead).
    </footer>
  </div>

  <script>
  /* ==========================
     CONFIG
  ===========================*/

  // ŒïŒπŒ¥ŒπŒ∫œåœÑŒ∑œÑŒµœÇ œÄŒøœÖ œÄœÅŒøœÉœÜŒ≠œÅŒµŒπœÇ
  const SERVICES = [
    { label:"Œ•Œ¥œÅŒ±œÖŒªŒπŒ∫œåœÇ",        icon:"üö∞ Œ•Œ¥œÅŒ±œÖŒªŒπŒ∫œåœÇ" },
    { label:"ŒóŒªŒµŒ∫œÑœÅŒøŒªœåŒ≥ŒøœÇ",      icon:"üí° ŒóŒªŒµŒ∫œÑœÅŒøŒªœåŒ≥ŒøœÇ" },
    { label:"ŒöŒªŒµŒπŒ¥Œ±œÅŒ¨œÇ",         icon:"üîë ŒöŒªŒµŒπŒ¥Œ±œÅŒ¨œÇ" },
    { label:"Œ®œÖŒ∫œÑŒπŒ∫œåœÇ (A/C)",    icon:"‚ùÑÔ∏è Œ®œÖŒ∫œÑŒπŒ∫œåœÇ" },
    { label:"ŒìŒµŒΩŒπŒ∫œåœÇ ŒºŒ¨œÉœÑŒøœÅŒ±œÇ",  icon:"üõ†Ô∏è ŒìŒµŒΩŒπŒ∫œåœÇ" },
    { label:"ŒÜŒªŒªŒø",              icon:"üîß ŒÜŒªŒªŒø" }
  ];

  // ŒïŒ¥œé ŒºœÄŒ±ŒØŒΩŒøœÖŒΩ ŒøŒπ ŒºŒ¨œÉœÑŒøœÅŒµœÇ (ŒµœÉœç œÑŒøœÖœÇ œÉœÖŒºœÄŒªŒ∑œÅœéŒΩŒµŒπœÇ)
  // Œ†Œ±œÅŒ¨Œ¥ŒµŒπŒ≥ŒºŒ± ŒºŒøœÅœÜŒÆœÇ:
  // {
  //   id: "m001",
  //   name: "ŒåŒΩŒøŒºŒ± ŒúŒ¨œÉœÑŒøœÅŒ±",
  //   type: "Œ•Œ¥œÅŒ±œÖŒªŒπŒ∫œåœÇ",
  //   areas: ["Œ†Œ±Œ≥Œ∫œÅŒ¨œÑŒπ","ŒùŒ≠Œ± Œ£ŒºœçœÅŒΩŒ∑"],
  //   phone: "6900000000",
  //   whatsapp: "6900000000",
  //   availability: "Œ£ŒÆŒºŒµœÅŒ±"
  // }
  const MASTORES = [
    // Œ¨œÜŒ∑œÉŒ≠ œÑŒø Œ∫ŒµŒΩœå Œ±ŒΩ Œ¥ŒµŒΩ Œ≠œáŒµŒπœÇ Œ±Œ∫œåŒºŒ± œÉœÖŒΩŒµœÅŒ≥Œ¨œÑŒµœÇ
  ];

  /* ==========================
     DOM refs
  ===========================*/
  const adminBar        = document.getElementById('adminBar');
  const exportCsvBtn    = document.getElementById('exportCsvBtn');

  const homeCard        = document.getElementById('homeCard');
  const formCard        = document.getElementById('formCard');
  const resultsCard     = document.getElementById('resultsCard');
  const successCard     = document.getElementById('successCard');

  const serviceGrid     = document.getElementById('serviceGrid');
  const toFormBtn       = document.getElementById('toFormBtn');

  const serviceSelect   = document.getElementById('serviceSelect');
  const areaInput       = document.getElementById('areaInput');
  const descInput       = document.getElementById('descInput');
  const urgencySelect   = document.getElementById('urgencySelect');
  const phoneInput      = document.getElementById('phoneInput');

  const findBtn         = document.getElementById('findBtn');
  const backHomeBtn     = document.getElementById('backHomeBtn');
  const backToFormBtn   = document.getElementById('backToFormBtn');
  const homeFromSuccess = document.getElementById('homeFromSuccess');

  const mastersList     = document.getElementById('mastersList');
  const noMasters       = document.getElementById('noMasters');

  /* ==========================
     UI Flow helpers
  ===========================*/
  function showStep(step){
    // step: 'home' | 'form' | 'results' | 'success'
    homeCard.style.display    = (step==='home')    ? '' : 'none';
    formCard.style.display    = (step==='form')    ? '' : 'none';
    resultsCard.style.display = (step==='results') ? '' : 'none';
    successCard.style.display = (step==='success') ? '' : 'none';
  }

  /* ==========================
     INIT UI
  ===========================*/
  function initUI(){
    // Build service tiles in STEP 1
    SERVICES.forEach(s=>{
      const tile = document.createElement('div');
      tile.className = 'panel';
      tile.style.cursor = 'pointer';
      tile.innerHTML = `
        <div style="font-size:.8rem;font-weight:600;color:var(--text-primary);letter-spacing:-0.03em;">
          ${s.icon}
        </div>
        <div style="font-size:.7rem;color:var(--text-dim);line-height:1.4;margin-top:4px;">
          ŒïœÄŒØŒªŒµŒæŒµ Œ∫Œ±Œπ œÉœÖŒΩŒ≠œáŒπœÉŒµ
        </div>
      `;
      tile.onclick = ()=>{
        // œÄœÅŒøŒµœÄŒπŒªŒøŒ≥ŒÆ œÉœÑŒø dropdown œÑŒ∑œÇ œÜœåœÅŒºŒ±œÇ
        serviceSelect.value = s.label;
        showStep('form');
      };
      serviceGrid.appendChild(tile);
    });

    // Fill serviceSelect dropdown
    SERVICES.forEach(s=>{
      const opt = document.createElement('option');
      opt.value = s.label;
      opt.textContent = s.label;
      serviceSelect.appendChild(opt);
    });

    // Button "Œ£œÖŒΩŒ≠œáŒµŒπŒ±" Œ±œÄœå œÑŒø œÄœÅœéœÑŒø Œ≤ŒÆŒºŒ±
    toFormBtn.onclick = ()=> showStep('form');

    // Back buttons
    backHomeBtn.onclick = ()=> showStep('home');
    backToFormBtn.onclick = ()=> showStep('form');
    homeFromSuccess.onclick = ()=> showStep('home');

    // Find technicians
    findBtn.onclick = onFind;

    // Admin mode
    const params = new URLSearchParams(location.search);
    if(params.get('admin')==='1'){
      adminBar.style.display='flex';
    }

    exportCsvBtn.onclick = exportLeadsCsv;
  }

  /* ==========================
     Search + render results
  ===========================*/
  function onFind(e){
    e?.preventDefault?.();

    const service = serviceSelect.value.trim();
    const area    = areaInput.value.trim();
    const desc    = descInput.value.trim();
    const urg     = urgencySelect.value.trim();
    const phone   = phoneInput.value.trim();

    if(!service || !area || !desc || !phone){
      alert("Œ£œÖŒºœÄŒªŒÆœÅœâœÉŒµ œåŒªŒ± œÑŒ± œÄŒµŒ¥ŒØŒ±.");
      return;
    }

    // Match logic
    const matches = MASTORES.filter(m=>{
      const typeOk =
        m.type === service ||
        (service==="ŒÜŒªŒªŒø" && m.type==="ŒìŒµŒΩŒπŒ∫œåœÇ ŒºŒ¨œÉœÑŒøœÅŒ±œÇ");
      const areaOk = m.areas.some(
        a => a.trim().toLowerCase() === area.toLowerCase()
      );
      return typeOk && areaOk;
    });

    renderResults(matches, {
      service,
      area,
      desc,
      urgency: urg,
      phone
    });
  }

  function renderResults(list, reqData){
    mastersList.innerHTML = '';
    if(!list.length){
      noMasters.style.display='';
    } else {
      noMasters.style.display='none';
    }

    list.forEach(m=>{
      const item = document.createElement('div');
      item.className = 'result-item';

      const left = document.createElement('div');
      left.innerHTML = `
        <div class="result-left-title">${m.name}</div>
        <div class="result-left-sub">${m.type} ¬∑ ${m.availability || "ŒîŒπŒ±Œ∏ŒµœÉŒπŒºœåœÑŒ∑œÑŒ±;"} </div>
        <div class="coverage">ŒöŒ±ŒªœçœÄœÑŒµŒπ: ${m.areas.join(', ')}</div>
      `;

      const right = document.createElement('div');
      right.className = 'action-row';

      const callBtn = document.createElement('button');
      callBtn.className = 'mini-btn call';
      callBtn.textContent = 'ŒöŒëŒõŒïŒ£Œï';
      callBtn.onclick = ()=>{
        recordLead(m, reqData, 'call');
        window.location.href = `tel:${m.phone}`;
      };

      const waBtn = document.createElement('button');
      waBtn.className = 'mini-btn wa';
      waBtn.textContent = 'WHATSAPP';
      waBtn.onclick = ()=>{
        recordLead(m, reqData, 'whatsapp');
        const msg =
`ŒìŒµŒπŒ± œÉŒøœÖ, œÉŒµ Œ≤œÅŒÆŒ∫Œ± Œ±œÄœå œÑŒø FixMyAthens.
Œàœáœâ œÑŒø ŒµŒæŒÆœÇ Œ∏Œ≠ŒºŒ±: ${reqData.desc}
Œ†ŒµœÅŒπŒøœáŒÆ: ${reqData.area}
Œ§Œ∑Œª: ${reqData.phone}`;
        const encoded = encodeURIComponent(msg);
        window.open(
          `https://wa.me/30${m.whatsapp}?text=${encoded}`,
          '_blank'
        );
      };

      right.appendChild(callBtn);
      right.appendChild(waBtn);

      item.appendChild(left);
      item.appendChild(right);

      mastersList.appendChild(item);
    });

    showStep('results');
  }

  /* ==========================
     Lead capture (local)
  ===========================*/
  function getLeads(){
    try {
      const raw = localStorage.getItem('fixmyathens_leads');
      return raw ? JSON.parse(raw) : [];
    } catch(e){
      return [];
    }
  }

  function saveLeads(arr){
    localStorage.setItem('fixmyathens_leads', JSON.stringify(arr));
  }

  function recordLead(master, reqData, channel){
    const leads = getLeads();
    leads.push({
      id:Date.now().toString(),
      ts:new Date().toISOString(),
      masterId:master.id || null,
      masterName:master.name || null,
      masterPhone:master.phone || null,
      channel,
      service:reqData.service,
      area:reqData.area,
      desc:reqData.desc,
      urgency:reqData.urgency,
      clientPhone:reqData.phone
    });
    saveLeads(leads);

    showStep('success');
  }

  /* ==========================
     Export CSV (admin mode)
  ===========================*/
  function exportLeadsCsv(){
    const leads = getLeads();
    if(!leads.length){
      alert("ŒîŒµŒΩ œÖœÄŒ¨œÅœáŒøœÖŒΩ leads Œ±Œ∫œåŒºŒ±.");
      return;
    }

    const headers = [
      "id","ts","masterId","masterName","masterPhone",
      "channel","service","area","desc","urgency","clientPhone"
    ];

    const rows = leads.map(l =>
      headers.map(h=> JSON.stringify(l[h] ?? "") ).join(',')
    );

    const csv = [headers.join(',')].concat(rows).join('\r\n');
    const blob = new Blob([csv], {type:'text/csv;charset=utf-8;'});
    const url = URL.createObjectURL(blob);

    const a = document.createElement('a');
    a.href = url;
    a.download = `fixmyathens_leads_${new Date().toISOString().slice(0,19).replace(/[:T]/g,'-')}.csv`;
    document.body.appendChild(a);
    a.click();
    a.remove();
  }

  /* ==========================
     INIT + service worker
  ===========================*/
  initUI();
  showStep('home');

  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('/service-worker.js')
      .catch(err => console.log('SW registration failed', err));
  }
  </script>
</body>
</html>
